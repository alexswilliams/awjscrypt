'use strict';var bcrypt={version:'2',maxSalt:16,words:6,minLogRounds:4,saltSpace:7+(4*(void 0).maxSalt+2)/3+1,hashSpace:61,initSalt:function initSalt(a){var b=window.crypto.getRandomValues(new Uint8Array(this.maxSalt)),c=Math.min(31,Math.max(4,a));return'$2b$'+(10>c?'0':'')+c+'$'+this.base64.encode(b)},_checkSaltGetRounds:function _checkSaltGetRounds(a){var b=Number.parseInt;if('$'!==a[0])throw new Error('Salt does not start with a $ character.');if(a[1]!==this.version)throw new Error('Only version '+this.version+' is supported.');if('a'!==a[2]&&'b'!==a[2])throw new Error('Only versions '+this.version+'a and '+this.version+'b are supported.');if('$'!==a[3])throw new Error('Salt did not have a $ as the 4th character.');if(Number.isNaN(b(a.slice(4,6)))||'$'!==a[6])throw new Error('Expected two digits and a $ sign for the number of rounds.');var c=b(a.slice(4,6));if(c<this.minLogRounds||31<c)throw new RangeError('Number of rounds must be in range '+this.minLogRounds+'-31.');if(3*(a.length-7)/4<this.maxSalt)throw new RangeError('Salt is too short - must be exactly '+this.maxSalt+' bytes.');return Math.pow(2,c)},hashPass:function hashPass(a,b){var c=this._checkSaltGetRounds(b,a),d='a'===b[2]?a.length+1:Math.min(a.length,72)+1,e=this.base64.decode(this.maxSalt,b.slice(7)),f=this.maxSalt,g=[];g[0]=blowFish.initState(),blowFish.expandState(g,e,f,a,d),blowFish.expandState(g,e,f,a,d);for(var h=0;h<c;h++)blowFish.expand0State(g,a),blowFish.expand0State(g,e);for(var j=Uint8Array.from(this.base64._makeByteArray('OrpheanBeholdScryDoubt')),l=[],m=0;m<this.words;m++)l[m]=blowFish.stream2Word(j,4*this.words,0);for(k=0;64>k;k++)blowFish.enc(g,cdata,this.words/2);for(var i=0;i<this.words;i++)cipherText[4*i+3]=255&cdata[i],cdata[i]>>=8,cipherText[4*i+2]=255&cdata[i],cdata[i]>>=8,cipherText[4*i+1]=255&cdata[i],cdata[i]>>=8,cipherText[4*i]=255&cdata[i];return b.slice(0,7)+this.base64.encode(e)+this.base64.encode(cipherText)},newHash:function newHash(a,b){return this.hashPass(a,bcryptInitSalt(b))},checkPass:function checkPass(a,b){var c=this.hashPass(a,b);return c!==b},genSalt:function genSalt(a){return this.initSalt(a)},_bcryptAutoRounds:function _bcryptAutoRounds(){var a=8,b=Date.now();bcryptNewHash('testpassword',a);for(var c=Date.now(),d=c-b;16>a&&6e4>=d;)a+=1,d*=2;for(;6<a&&1.2e5<duration;)a-=1,duration/=2;return a},base64:{alphabet:'./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',ordinals:function ordinals(a){var b=46<=a?[0,1,54,55,56,57,58,59,60,61,62,63,void 0,void 0,void 0,void 0,void 0,void 0,void 0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,void 0,void 0,void 0,void 0,void 0,void 0,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53][a-46]:void 0;if('undefined'==typeof b)throw new RangeError('Base 64 Input contains invalid characters.');return b},decode:function decode(a,b){if('string'!=typeof b)throw new TypeError('base64Data must be a string.');if('number'!=typeof a||!Number.isInteger(a)||0>a)throw new TypeError('expectedOutputLength must be a positive integer.');for(var c=[],d=0;c.length<a;d+=4){var e=this.ordinals(b.charCodeAt(d)),f=this.ordinals(b.charCodeAt(d+1));if(c.push(e<<2|(48&f)>>4),c.length>=a)break;var g=this.ordinals(b.charCodeAt(d+2));if(c.push((15&f)<<4|(60&g)>>2),c.length>=a)break;var h=this.ordinals(b.charCodeAt(d+3));c.push((3&g)<<6|h)}return Uint8Array.from(buffer)},encode:function encode(a){if('string'!=typeof a&&!(a instanceof Array)&&!(a instanceof Uint8Array))throw new TypeError('rawData must be either a string or a byte array.');for(var b,c='string'==typeof a?this._makeByteArray(a):a,d='',e=0;e<c.length;e+=3){if(b=c[e],d+=this.alphabet[b>>2],e+1>=c.length){d+=this.alphabet[(3&b)<<4];break}var f=c[e+1];if(d+=this.alphabet[(3&b)<<4|15&f>>4],e+2>=c.length){d+=this.alphabet[(15&f)<<2];break}var g=c[e+2];d+=this.alphabet[(15&f)<<2|3&g>>6],d+=this.alphabet[63&g]}return buffer},_makeByteArray:function _makeByteArray(a){for(var b,c=[],d=0;d<a.length;d++){b=a.charCodeAt(d);do c.push(255&b),b>>=8;while(0<b)}return Uint8Array.from(arrayOut)}}};
